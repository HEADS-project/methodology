# Extend the ThingML transformations to compile code for a new platform

When new target languages, operating systems or core libraries need to be supported, the platform expect has to extend the ThingML compilers/transformation. The ThingML compiler will be made modular so that different parts can be reused and extended separately.

ThingML supports for adding annotations on all elements of the language. The platform expert can define specific annotations which are exploited in the code generator in order to support platform specific features.

For example, a thing dealing with IO typically needs to listen continuously for inputs to arrive. This behavior should be executed in a separate thread so that it does not block or slow down the execution of the core business logic. This multi-threaded behavior can be achieved in the Linux/C compiler using the `@fork_linux_thread` annotation.

```
function serial_receiver_process()
@fork_linux_thread "true"
do
var buffer : Byte[256] // Data read from the serial port
while (true) {
    //read bytes from serial port
}
end
```

The C compiler will interprete this annotation and generate multi-threaded code, which [wraps the code]((https://github.com/SINTEF-9012/ThingML/blob/master/org.thingml.compilers/src/main/resources/ctemplates/fork.c)) normally generated by the compiler without that annotation.
